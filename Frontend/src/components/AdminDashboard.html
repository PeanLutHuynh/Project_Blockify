<!-- Admin Dashboard Component -->
<div class="dashboard-wrapper">
  <!-- Date Range Filter -->
  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <div class="row align-items-center">
        <div class="col-md-3">
          <label class="form-label fw-semibold">Từ ngày</label>
          <input type="date" class="form-control" id="dashboardStartDate">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-semibold">Đến ngày</label>
          <input type="date" class="form-control" id="dashboardEndDate">
        </div>
        <div class="col-md-2">
          <label class="form-label fw-semibold">Nhóm theo</label>
          <select class="form-select" id="dashboardGroupBy">
            <option value="day">Ngày</option>
            <option value="month" selected>Tháng</option>
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label fw-semibold d-block">&nbsp;</label>
          <button class="btn btn-primary me-2" id="applyDashboardFilter">
            <i class="bi bi-funnel me-1"></i>Áp dụng
          </button>
          <button class="btn btn-outline-secondary" id="resetDashboardFilter">
            <i class="bi bi-arrow-counterclockwise me-1"></i>Đặt lại
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Overview Cards -->
  <div class="row g-3 mb-4">
    <div class="col-12 col-md-6 col-lg-3">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h6 class="text-muted mb-2">Tổng doanh thu</h6>
              <h3 class="fw-bold mb-0" id="totalRevenue">—</h3>
              <small class="text-success" id="revenueChange">—</small>
            </div>
            <div class="icon-box bg-primary bg-opacity-10 p-3 rounded">
              <i class="bi bi-cash-stack text-primary fs-4"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-6 col-lg-3">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h6 class="text-muted mb-2">Đơn hàng thành công</h6>
              <h3 class="fw-bold mb-0" id="successOrders">—</h3>
              <small class="text-muted" id="successRate">—</small>
            </div>
            <div class="icon-box bg-success bg-opacity-10 p-3 rounded">
              <i class="bi bi-check-circle text-success fs-4"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-6 col-lg-3">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h6 class="text-muted mb-2">Tỷ lệ chuyển đổi</h6>
              <h3 class="fw-bold mb-0" id="conversionRate">—</h3>
              <small class="text-muted" id="conversionDetail">—</small>
            </div>
            <div class="icon-box bg-warning bg-opacity-10 p-3 rounded">
              <i class="bi bi-graph-up-arrow text-warning fs-4"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-6 col-lg-3">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h6 class="text-muted mb-2">Khách hàng mới</h6>
              <h3 class="fw-bold mb-0" id="newCustomers">—</h3>
              <small class="text-info" id="customerGrowth">—</small>
            </div>
            <div class="icon-box bg-info bg-opacity-10 p-3 rounded">
              <i class="bi bi-people text-info fs-4"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row g-3 mb-4">
    <!-- Revenue Chart -->
    <div class="col-12 col-lg-8">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-white border-bottom">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0 fw-bold">
              <i class="bi bi-bar-chart-line me-2"></i>Báo cáo doanh thu
            </h5>
            <div class="btn-group btn-group-sm" role="group">
              <button type="button" class="btn btn-outline-primary active" id="chartTypeDay" data-type="day">
                Theo ngày
              </button>
              <button type="button" class="btn btn-outline-primary" id="chartTypeMonth" data-type="month">
                Theo tháng
              </button>
            </div>
          </div>
        </div>
        <div class="card-body">
          <canvas id="revenueChart" style="max-height: 350px;"></canvas>
          <div id="revenueChartLoader" class="text-center py-5 d-none">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Đang tải...</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Order Stats Chart -->
    <div class="col-12 col-lg-4">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-white border-bottom">
          <h5 class="mb-0 fw-bold">
            <i class="bi bi-pie-chart me-2"></i>Trạng thái đơn hàng
          </h5>
        </div>
        <div class="card-body">
          <canvas id="orderStatsChart" style="max-height: 350px;"></canvas>
          <div id="orderStatsLoader" class="text-center py-5 d-none">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Đang tải...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Row -->
  <div class="row g-3">
    <!-- Popular Categories -->
    <div class="col-12 col-lg-6">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-white border-bottom">
          <h5 class="mb-0 fw-bold">
            <i class="bi bi-fire me-2"></i>Danh mục bán chạy
          </h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <thead>
                <tr>
                  <th>Danh mục</th>
                  <th class="text-end">Sản phẩm</th>
                  <th class="text-end">Doanh số</th>
                  <th class="text-end">Doanh thu</th>
                </tr>
              </thead>
              <tbody id="popularCategoriesTable">
                <tr>
                  <td colspan="4" class="text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                      <span class="visually-hidden">Đang tải...</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Conversion Details -->
    <div class="col-12 col-lg-6">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-white border-bottom">
          <h5 class="mb-0 fw-bold">
            <i class="bi bi-graph-up me-2"></i>Chi tiết chuyển đổi
          </h5>
        </div>
        <div class="card-body">
          <div id="conversionDetails">
            <div class="mb-4">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="text-muted">Tổng người dùng</span>
                <strong id="totalUsers">—</strong>
              </div>
              <div class="progress" style="height: 10px;">
                <div class="progress-bar bg-info" id="totalUsersBar" style="width: 100%"></div>
              </div>
            </div>

            <div class="mb-4">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="text-muted">Người dùng có đơn hàng</span>
                <strong id="usersWithOrders">—</strong>
              </div>
              <div class="progress" style="height: 10px;">
                <div class="progress-bar bg-warning" id="usersWithOrdersBar" style="width: 0%"></div>
              </div>
            </div>

            <div class="mb-4">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="text-muted">Người dùng có giỏ hàng</span>
                <strong id="usersWithCarts">—</strong>
              </div>
              <div class="progress" style="height: 10px;">
                <div class="progress-bar bg-success" id="usersWithCartsBar" style="width: 0%"></div>
              </div>
            </div>

            <div class="mb-3">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="text-muted">Tổng đơn hàng</span>
                <strong id="totalOrdersConv">—</strong>
              </div>
              <div class="progress" style="height: 10px;">
                <div class="progress-bar bg-primary" id="totalOrdersBar" style="width: 0%"></div>
              </div>
            </div>

            <hr>

            <div class="row text-center mt-4">
              <div class="col-6">
                <h6 class="text-muted mb-2">Tỷ lệ đặt hàng</h6>
                <h4 class="fw-bold text-primary" id="orderConversionRate">—</h4>
                <small class="text-muted">User → Order</small>
              </div>
              <div class="col-6">
                <h6 class="text-muted mb-2">Tỷ lệ chuyển đổi giỏ</h6>
                <h4 class="fw-bold text-success" id="cartConversionRate">—</h4>
                <small class="text-muted">Cart → Order</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.icon-box {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 60px;
  height: 60px;
}

.btn-group-sm .btn {
  font-size: 0.875rem;
  padding: 0.375rem 0.75rem;
}

.table th {
  font-weight: 600;
  color: #6c757d;
  font-size: 0.875rem;
}

.progress {
  border-radius: 10px;
  background-color: #e9ecef;
}

.progress-bar {
  border-radius: 10px;
  transition: width 0.6s ease;
}

.card {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
}
</style>

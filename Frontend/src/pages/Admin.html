
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>B·∫£ng ƒëi·ªÅu khi·ªÉn qu·∫£n tr·ªã</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/pages/Admin.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  
  <!-- Supabase JS SDK t·ª´ CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <!-- Header -->
  <div class="header d-flex justify-content-between align-items-center">
    <div class="header-left d-flex align-items-center gap-3">
      <button class="toggle-sidebar-btn d-lg-none" style="background-color: #68c0ff; color: white;" id="toggleSidebarBtn" aria-label="M·ªü menu">
        <i class="bi bi-list"></i>
      </button>
      <a class="navbar-brand" href="#git add ">Blockify</a>
    </div>
    <div class="header-right d-flex align-items-center gap-2">
      <span id="adminName" class="header-link">ƒêang t·∫£i...</span>
      <a href="#" id="logoutBtn" class="header-link">üë§ ƒêƒÉng xu·∫•t</a>
    </div>
  </div>

  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar d-flex flex-column">
      <div class="user d-flex align-items-center gap-2 mb-3">
        <img src="../../public/images/Group 40.png" alt="avatar">
        <div class="name">QTLHH</div>
      </div>
      <ul class="menu nav flex-column">
        <li class="active nav-item" data-target="dashboard">
          <i class="bi bi-speedometer2 me-2"></i>B·∫£ng ƒëi·ªÅu khi·ªÉn
        </li>
        
        <li class="nav-item" data-target="customer">
          <i class="bi bi-people-fill me-2 text-secondary"></i>Kh√°ch h√†ng
        </li>        
        <li class="nav-item" data-target="product">
          <i class="bi bi-box-seam me-2"></i>S·∫£n ph·∫©m
        </li>
        <li class="nav-item" data-target="order">
          <i class="bi bi-receipt-cutoff me-2"></i>ƒê∆°n h√†ng
        </li>
        <li class="nav-item" data-target="shop-info">
          <i class="bi bi-shop me-2"></i>Th√¥ng tin c·ª≠a h√†ng
        </li>
        <li class="nav-item" data-target="feedback-manager">
          <i class="bi bi-chat-dots me-2"></i>ƒê√°nh gi√° s·∫£n ph·∫©m
        </li>
        <li class="nav-item" data-target="voucher">
          <i class="bi bi-ticket-perforated me-2"></i>Qu·∫£n l√Ω Voucher
        </li>
        <li class="nav-item" data-target="notification">
          <i class="bi bi-bell-fill me-2 text-secondary"></i>Th√¥ng b√°o
        </li>
        
      </ul>
    </aside>

    <main class="main container-fluid">
      <!-- Dashboard -->
      <section id="dashboard" class="section active">
        <div class="bar-blue"><h4 class="mb-0"> <i class="bi bi-speedometer2 me-2"></i>B·∫£ng ƒëi·ªÅu khi·ªÉn</h4></div>
        <!-- Metrics Cards -->
        <div class="metrics-grid row g-3 mb-4">
          <div class="metric-card col-12 ">
            <div class="title">T·ªïng b√°n</div>
            <div class="value">‚Äî</div>
          </div>
          <div class="metric-card col-12 ">
            <div class="title">S·∫£n ph·∫©m m·ªõi</div>
            <div class="value">30</div>
          </div>
          <div class="metric-card col-12 ">
            <div class="title">Kh√°ch h√†ng m·ªõi</div>
            <div class="value">310</div>
          </div>
          <div class="metric-card col-12">
            <div class="title">T·ªìn kho</div>
            <div class="value">‚Äî</div>
          </div>
        </div>
        <!-- Dashboard Content -->
        <div class="dashboard-content row g-3">
          <!-- Chart Panel -->
          <div class="chart-panel col-12 col-lg-8">
            <div class="chart-header d-flex gap-3 mb-3">
              <div class="chart-tab">Doanh thu th√°ng</div>
              <div class="chart-tab inactive">Doanh thu ng√†y</div>
            </div>
            <div class="chart-container">
              <div class="chart-line"></div>
              <div class="chart-points">
                <div class="chart-point" style="height: 20px;"></div>
                <div class="chart-point" style="height: 35px;"></div>
                <div class="chart-point" style="height: 28px;"></div>
                <div class="chart-point" style="height: 45px;"></div>
                <div class="chart-point" style="height: 52px;"></div>
                <div class="chart-point" style="height: 38px;"></div>
                <div class="chart-point" style="height: 65px;"></div>
                <div class="chart-point" style="height: 58px;"></div>
                <div class="chart-point" style="height: 72px;"></div>
                <div class="chart-point" style="height: 45px;"></div>
                <div class="chart-point" style="height: 80px;"></div>
                <div class="chart-point" style="height: 85px;"></div>
              </div>
            </div>
          </div>
          <!-- Best Selling Products -->
          <div class="products-panel col-12 ">
            <div class="panel-title">S·∫£n ph·∫©m b√°n ch·∫°y</div>
            <div class="product-list">
              <div class="product-item d-flex align-items-center gap-2">
                <img class="product-thumb" src="img/Rectangle 108 (1).png" alt="">
                <div class="product-info">
                  <div class="product-name">Nh√† ƒë·ªÉ xe - 34 xe</div>
                  <div class="product-price">245.000 VND</div>
                </div>
              </div>
              <div class="product-item d-flex align-items-center gap-2">
                <img class="product-thumb" src="img/Rectangle 108 (2).png" alt="">
                <div class="product-info">
                  <div class="product-name">Xe c·∫£nh s√°t</div>
                  <div class="product-price">230.000 VND</div>
                </div>
              </div>
              <div class="product-item d-flex align-items-center gap-2">
                <img class="product-thumb" src="img/Rectangle 108 (3).png" alt="">
                <div class="product-info">
                  <div class="product-name">Xe x√¢y d·ª±ng m√†u v√†ng</div>
                  <div class="product-price">199.000 VND</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Customer -->
      <section id="customer" class="section">
        <div class="bar-blue">
          <h4 class="mb-0"><i class="bi bi-people-fill me-2"></i>Qu·∫£n l√Ω Kh√°ch h√†ng</h4>
        </div>
        <div class="card">
          <div class="card-body">
            <div class="toolbar d-flex gap-2 mb-3">
              <input class="search form-control" placeholder="T√¨m ki·∫øm kh√°ch h√†ng">
            </div>
            <div class="table-responsive">
              <table class="table table-bordered table-hover align-middle">
                <thead>
                  <tr>
                    <th style="width:40px;"><input type="checkbox"></th>
                    <th>T√™n</th>
                    <th>Email</th>
                    <th>S·ªë ƒëi·ªán tho·∫°i</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>H√†nh ƒë·ªông</th>
                  </tr>
                </thead>
                <tbody id="customerList"></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <!-- Product Management -->
      <section id="product" class="section">
        <!-- Header -->
        <div class="bar-blue">
          <h4 class="mb-0"><i class="bi bi-box-seam me-2"></i>Qu·∫£n l√Ω S·∫£n Ph·∫©m</h4>
        </div>

        <!-- Tabs -->
        <ul class="nav nav-tabs mb-3" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="all-products-tab" data-bs-toggle="tab" data-bs-target="#all-products" type="button" role="tab">
              T·∫•t C·∫£ S·∫£n Ph·∫©m
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="categories-tab" data-bs-toggle="tab" data-bs-target="#categories-content" type="button" role="tab">
              Qu·∫£n L√Ω Danh M·ª•c
            </button>
          </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content">
          <!-- All Products Tab -->
          <div class="tab-pane fade show active" id="all-products" role="tabpanel">
        
        <!-- Search and Filter Bar -->
        <div class="card mb-3">
          <div class="card-body">
            <!-- First Row -->
            <div class="row g-3 mb-2">
              <div class="col-md-4">
                <div class="input-group">
                  <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
                  <input type="text" class="form-control" placeholder="Vui l√≤ng nh·∫≠p t·ªëi thi·ªÉu 2 k√Ω t·ª±" id="productSearch">
                </div>
              </div>
              <div class="col-md-2">
                <select class="form-select" id="categoryFilter">
                  <option value="">Danh m·ª•c</option>
                </select>
              </div>
              <div class="col-md-2">
                <select class="form-select" id="stockFilter">
                  <option value="">Kho h√†ng</option>
                  <option value="in_stock">C√≤n h√†ng</option>
                  <option value="out_of_stock">H·∫øt h√†ng</option>
                  <option value="low_stock">S·∫Øp h·∫øt</option>
                </select>
              </div>
              <div class="col-md-2">
                <select class="form-select" id="statusFilter">
                  <option value="">Tr·∫°ng th√°i</option>
                  <option value="active">ƒêang b√°n</option>
                  <option value="inactive">Ng·ª´ng b√°n</option>
                </select>
              </div>
              <div class="col-md-2">
                <button class="btn btn-primary w-100" onclick="window.adminProductController?.applyFilters()">
                  <i class="bi bi-funnel me-1"></i>T√¨m
                </button>
              </div>
            </div>

            <!-- Second Row - Additional Filters -->
            <div class="row g-3">
              <div class="col-md-2">
                <select class="form-select" id="difficultyFilter">
                  <option value="">ƒê·ªô kh√≥</option>
                  <option value="Easy">D·ªÖ (Easy)</option>
                  <option value="Medium">Trung b√¨nh (Medium)</option>
                  <option value="Hard">Kh√≥ (Hard)</option>
                  <option value="Expert">Chuy√™n gia (Expert)</option>
                </select>
              </div>
              <div class="col-md-2">
                <select class="form-select" id="featuredFilter">
                  <option value="">N·ªïi b·∫≠t</option>
                  <option value="true">C√≥</option>
                  <option value="false">Kh√¥ng</option>
                </select>
              </div>
              <div class="col-md-2">
                <select class="form-select" id="newFilter">
                  <option value="">S·∫£n ph·∫©m m·ªõi</option>
                  <option value="true">C√≥</option>
                  <option value="false">Kh√¥ng</option>
                </select>
              </div>
              <div class="col-md-2">
                <select class="form-select" id="bestsellerFilter">
                  <option value="">B√°n ch·∫°y</option>
                  <option value="true">C√≥</option>
                  <option value="false">Kh√¥ng</option>
                </select>
              </div>
              <div class="col-md-4">
                <button class="btn btn-outline-secondary w-100" onclick="window.adminProductController?.resetFilters()">
                  <i class="bi bi-arrow-counterclockwise me-1"></i>ƒê·∫∑t l·∫°i b·ªô l·ªçc
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Product List -->
        <div class="card">
              <div class="card-body">
                <!-- Action Bar -->
                <div class="d-flex justify-content-between align-items-center mb-3">                                                                            <div>
                    <span class="text-muted" id="productCountText">0 S·∫£n Ph·∫©m</span>                                                                            </div>
                  <div>
                    <button class="btn btn-link text-primary" onclick="window.location.reload()">                                                                   <i class="bi bi-arrow-clockwise me-1"></i>T·ªëi ∆∞u s·∫£n ph·∫©m                                                                                   </button>
                    <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#addProductModal">                                                        <i class="bi bi-plus-circle me-1"></i>Th√™m 1 s·∫£n ph·∫©m m·ªõi                                                                                   </button>
                    <div class="btn-group ms-2">
                      <button class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" id="bulkActionDropdown">                                    C√¥ng c·ª• X·ª≠ l√Ω h√†ng lo·∫°t
                      </button>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" id="bulkEditBtn"><i class="bi bi-pencil me-2"></i>Ch·ªânh s·ª≠a h√†ng lo·∫°t</a></li>                          <li><a class="dropdown-item" href="#" id="bulkDeleteBtn"><i class="bi bi-trash me-2"></i>X√≥a h√†ng lo·∫°t</a></li>                             </ul>
                    </div>
                  </div>
                </div>

                <!-- Product Table -->
                <div class="table-responsive">
                  <table class="table table-hover align-middle">
                    <thead>
                      <tr>
                        <th width="40"><input type="checkbox" class="form-check-input" id="selectAllCheckbox"></th>
                        <th width="330">T√™n s·∫£n ph·∫©m</th>
                        <th width="120">SKU ph√¢n lo·∫°i</th>
                        <th width="120">Ph√¢n lo·∫°i h√†ng</th>
                        <th width="120" style="cursor: pointer;" data-sort="price">
                          Gi√° <i class="bi bi-arrow-down-up" id="sortPriceIcon"></i>
                        </th>
                        <th width="120" style="cursor: pointer;" data-sort="stock_quantity">
                          Kho h√†ng <i class="bi bi-arrow-down-up" id="sortStockIcon"></i>
                        </th>
                        <th width="100">Doanh s·ªë</th>
                        <th width="100">Thao t√°c</th>
                      </tr>
                    </thead>
                    <tbody id="productList">
                      <!-- Products will be rendered here -->
                    </tbody>
                  </table>
                </div>

                <!-- Product Count -->
                <div class="d-flex justify-content-between align-items-center mt-3">
                  <div>
                    <span class="text-muted">T·ªïng: <span id="totalProducts">0</span> s·∫£n ph·∫©m</span>
                  </div>
                </div>
              </div>
            </div>

          </div>
          <!-- End All Products Tab -->

          <!-- Categories Tab -->
          <div class="tab-pane fade" id="categories-content" role="tabpanel">
            
            <!-- Search Bar -->
            <div class="card mb-3">
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="input-group">
                      <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
                      <input type="text" class="form-control" placeholder="T√¨m ki·∫øm danh m·ª•c..." id="categorySearch">
                    </div>
                  </div>
                  <div class="col-md-6 text-end">
                    <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
                      <i class="bi bi-plus-circle me-1"></i>Th√™m Danh M·ª•c M·ªõi
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Categories Table -->
            <div class="card">
              <div class="card-body">
                <!-- Action Bar -->
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div>
                    <span class="text-muted" id="categoryCountText">0 Danh M·ª•c</span>
                  </div>
                </div>

                <!-- Table -->
                <div class="table-responsive">
                  <table class="table table-hover align-middle">
                    <thead>
                      <tr>
                        <th width="80">ID</th>
                        <th width="200">T√™n Danh M·ª•c</th>
                        <th width="200">Slug</th>
                        <th>M√¥ T·∫£</th>
                        <th width="120">S·ªë S·∫£n Ph·∫©m</th>
                        <th width="150">Thao T√°c</th>
                      </tr>
                    </thead>
                    <tbody id="categoryList">
                      <!-- Categories will be rendered here -->
                    </tbody>
                  </table>
                </div>

                <!-- Total Count -->
                <div class="d-flex justify-content-between align-items-center mt-3">
                  <div>
                    <span class="text-muted">T·ªïng: <span id="totalCategories">0</span> danh m·ª•c</span>
                  </div>
                </div>
              </div>
            </div>

          </div>
          <!-- End Categories Tab -->

        </div>
        <!-- End Tab Content -->

      </section>

      <!-- Shop Info -->
      <section id="shop-info" class="section h-100">
        <div class="bar-blue mb-4"><h4 class="mb-0"> <i class="bi bi-shop me-2"></i>Th√¥ng tin c·ª≠a h√†ng</h4></div>
        <div class="shop-info-panel panel">
          <form id="shopInfoForm">
            <div class="row mb-3 align-items-center">
              
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">T√™n c·ª≠a h√†ng</label>
                  <input type="text" id="shopName" class="form-control" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">ƒê·ªãa ch·ªâ</label>
                  <input type="text" id="shopAddress" class="form-control">
                </div>
                <div class="mb-3">
                  <label class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                  <input type="text" id="shopPhone" class="form-control">
                </div>
                <div class="mb-3">
                  <label class="form-label">Email</label>
                  <input type="email" id="shopEmail" class="form-control">
                </div>
                <div class="mb-3">
                  <label class="form-label">M√¥ t·∫£</label>
                  <textarea id="shopDesc" class="form-control" rows="2"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
              </div>
              <div class="col-md-6 text-center mb-3 mb-md-0">
                <div class ="row">
                  <div class ="col-md-6 mx-auto mt-4">
                    <img id="shopLogoPreview" src="../../public/images/Group 40.png" alt="Logo shop" class="shop-logo img-thumbnail">
                <input type="file" id="shopLogo" class="form-control mt-5">
                  </div>
                </div>
                
              </div>
            </div>
          </form>
        </div>
      </section>

      <!-- Order -->
      <section id="order" class="section">
        <div class="bar-blue"><h4 class="mb-0"> <i class="bi bi-receipt-cutoff me-2"></i>Qu·∫£n l√Ω ƒë∆°n h√†ng</h4></div>
        <div class="toolbar">
          <input class="search" placeholder="T√¨m ƒë∆°n h√†ng">
        </div>
        <div class="table-responsive">
          <table class="table align-middle text-center table-hover" id="orderTable">
            <thead>
              <tr>
                <th>M√£ ƒë∆°n</th>
                <th>Kh√°ch h√†ng</th>
                <th>Email</th>
                <th>SƒêT</th>
                <th>Ng√†y ƒë·∫∑t</th>
                <th>T·ªïng ti·ªÅn</th>
                <th>Tr·∫°ng th√°i ƒë∆°n</th>
                <th>Thanh to√°n</th>
                <th>H√†nh ƒë·ªông</th>
              </tr>
            </thead>
            <tbody id="orderList"></tbody>
          </table>
        </div>
      </section>
      
      <!-- Modal Chi ti·∫øt ƒê∆°n h√†ng -->
      <div class="modal fade" id="orderDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg"><div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Chi ti·∫øt ƒë∆°n h√†ng</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="container">
              <div class="row mb-2"><div class="col-5 fw-semibold">Kh√°ch h√†ng:</div><div class="col" id="detailCustomerName"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">Email:</div><div class="col" id="detailCustomerEmail"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">SƒêT:</div><div class="col" id="detailCustomerPhone"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">ƒê·ªãa ch·ªâ:</div><div class="col" id="detailCustomerAddress"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">Ph∆∞∆°ng th·ª©c:</div><div class="col" id="detailPaymentMethod"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">M√£ h√≥a ƒë∆°n:</div><div class="col" id="detailOrderId"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">T√™n ƒë∆°n:</div><div class="col" id="detailOrderName"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">S·ªë l∆∞·ª£ng:</div><div class="col" id="detailOrderQuantity"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">M·∫´u h√†ng:</div><div class="col" id="detailOrderVariant"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">T·ªïng ti·ªÅn:</div><div class="col" id="detailOrderTotal"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">Tr·∫°ng th√°i:</div><div class="col" id="detailOrderStatus"></div></div>
              <div class="row mb-2"><div class="col-5 fw-semibold">H√¨nh s·∫£n ph·∫©m:</div><div class="col"><img id="detailProductImg" src="" class="img-fluid mb-2" style="max-width: 100px;"></div></div>
              <div class="row mb-2">
                <div class="col-5 fw-semibold">Minh ch·ª©ng thanh to√°n:</div>
                <div class="col">
                  <img id="detailPayProof" src="" class="img-fluid" style="max-width: 120px; cursor: pointer;" onclick="window.open(this.src, '_blank')">
                  <div class="mt-2">
                    <span class="badge bg-secondary" id="paymentStatusBadge">Ch∆∞a ki·ªÉm tra</span>
                  </div>
                  <div class="mt-2" id="paymentVerifyActions" style="display:none;">
                    <button type="button" class="btn btn-success btn-sm me-2" id="approvePaymentBtn">‚úì X√°c nh·∫≠n thanh to√°n</button>
                    <button type="button" class="btn btn-danger btn-sm" id="rejectPaymentBtn">‚úó T·ª´ ch·ªëi thanh to√°n</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer order-action-footer">
            <button type="button" class="btn btn-success next-status-btn">C·∫≠p nh·∫≠t tr·∫°ng th√°i</button>
            <button type="button" class="btn btn-warning refund-btn">X·ª≠ l√Ω ho√†n tr·∫£</button>
            <button type="button" class="btn btn-danger cancel-btn">H·ªßy ƒë∆°n</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
          </div>
        </div></div>
      </div>
      
      <!-- Modal X·ª≠ l√Ω ho√†n tr·∫£ -->
      <div class="modal fade" id="refundModal" tabindex="-1">
        <div class="modal-dialog"><div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">X·ª≠ l√Ω ho√†n/tr·∫£ h√†ng</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="refundForm">
              <div class="mb-3">
                <label class="form-label">S·∫£n ph·∫©m ho√†n tr·∫£</label>
                <input type="text" id="refundProduct" class="form-control" readonly>
              </div>
              <div class="mb-3">
                <label class="form-label">L√Ω do ho√†n tr·∫£</label>
                <textarea id="refundReason" class="form-control" rows="3" placeholder="Nh·∫≠p l√Ω do ho√†n/tr·∫£ h√†ng..."></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success" id="confirmRefund">X√°c nh·∫≠n ho√†n tr·∫£</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
          </div>
        </div></div>
      </div>

      <!-- Feedback Manager -->
      <section id="feedback-manager" class="section">
        <div class="bar-blue"><h4 class="mb-0"> <i class="bi bi-chat-dots me-2"></i>Qu·∫£n l√Ω ƒë√°nh gi√° s·∫£n ph·∫©m</h4></div>
        <div class="panel">
            <div class="feedback-list">
              <div class="feedback-item d-flex align-items-start gap-3">
                <img src="img/Rectangle 108 (2).png" class="feedback-thumb" alt="">
                <div class="flex-fill">
                  <div class="d-flex justify-content-between align-items-center">
                    <strong class="feedback-product">Xe c·∫£nh s√°t</strong>
                    <span class="badge bg-primary ms-2">M·ªõi</span>
                  </div>
                  <div><b>T√™n kh√°ch:</b> Nguy·ªÖn VƒÉn A ¬∑ <b>Email:</b> vana@gmail.com ¬∑ <b>ƒê√°nh gi√°:</b>
                    <span class="text-warning">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                  </div>
                  <div><i>"S·∫£n ph·∫©m r·∫•t t·ªët, giao h√†ng nhanh!"</i></div>
                  <div class="feedback-actions mt-1">
                    <button type="button" class="btn btn-outline btn-sm view-feedback-btn" data-feedback-id="FB001" data-bs-toggle="modal" data-bs-target="#feedbackDetailModal">Xem</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm ms-2 acknowledge-feedback-btn" data-feedback-id="FB001">Ghi nh·∫≠n</button>
                  </div>
                </div>
              </div>
              <div class="feedback-item d-flex align-items-start gap-3 mt-3">
                <img src="img/Rectangle 108 (3).png" class="feedback-thumb" alt="">
                <div class="flex-fill">
                  <div class="d-flex justify-content-between align-items-center">
                    <strong class="feedback-product">Xe x√¢y d·ª±ng v√†ng</strong>
                    <span class="badge bg-primary ms-2">M·ªõi</span>
                  </div>
                  <div><b>T√™n kh√°ch:</b> Tr·∫ßn B·∫£o B ¬∑ <b>Email:</b> baobb@gmail.com ¬∑ <b>ƒê√°nh gi√°:</b>
                    <span class="text-warning">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                  </div>
                  <div><i>"ƒê√∫ng m√¥ t·∫£, b√© nh√† m√¨nh th√≠ch l·∫Øm."</i></div>
                  <div class="feedback-actions mt-1">
                    <button type="button" class="btn btn-outline btn-sm view-feedback-btn" data-feedback-id="FB002">Xem</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm ms-2 acknowledge-feedback-btn" data-feedback-id="FB002">Ghi nh·∫≠n</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </section>

      <!-- Voucher Management -->
      <section id="voucher" class="section">
        <!-- Voucher Navbar -->
        <div class="bar-blue">
         <h4 class="mb-0">  <i class="bi bi-ticket-perforated me-2"></i>Qu·∫£n l√Ω Voucher</h4>
        </div>
        <div class="toolbar">
          <input class="search" placeholder="T√¨m voucher">
          <button class="btn btn-danger add-btn" data-bs-toggle="modal" data-bs-target="#addVoucherModal">+ Th√™m voucher</button>
        </div>
        
        <!-- Voucher List -->
        <div class="row g-3" id="voucherList">
          <!-- Vouchers will be rendered here -->
        </div>
      </section>

      <!-- Notification -->
      <section id="notification" class="section">
        <div class="bar-blue"><h4 class="mb-0"> <i class="bi bi-bell-fill me-2"></i>Th√¥ng b√°o</h4></div>
        <div class="toolbar">
          <input class="search" placeholder="T√¨m th√¥ng b√°o">
          <button class="btn btn-outline" title="X√≥a"><span>üóë</span></button>
        </div>
        <div class="panel">
          <div class="note">
            <strong>Giao h√†ng</strong>
            <div>ƒê∆°n h√†ng 1234 ƒë√£ ƒë∆∞·ª£c giao th√†nh c√¥ng</div>
          </div>
        </div>
      </section>
      <!-- Modal ph·∫£n h·ªìi ƒë√°nh gi√° -->
      <div class="modal fade" id="feedbackDetailModal" tabindex="-1" aria-labelledby="feedbackDetailLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="feedbackDetailLabel">Chi ti·∫øt ƒë√°nh gi√°/Ph·∫£n h·ªìi</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
            </div>
            <div class="modal-body">
              <div class="mb-2"><strong>S·∫£n ph·∫©m:</strong> <span id="feedbackProductName"></span></div>
              <div class="mb-2"><strong>Kh√°ch h√†ng:</strong> <span id="feedbackCustomer"></span> <span class="muted">(<span id="feedbackCustomerEmail"></span>)</span></div>
              <div class="mb-2"><strong>ƒê√°nh gi√°:</strong> <span id="feedbackStars"></span></div>
              <div class="mb-2"><strong>N·ªôi dung ph·∫£n h·ªìi:</strong>
                <div class="border rounded p-2 bg-light" id="feedbackContent"></div>
              </div>
              <div class="mt-3">
                <label for="adminReply" class="form-label"><strong>Ph·∫£n h·ªìi/Ghi nh·∫≠n c·ªßa qu·∫£n tr·ªã vi√™n:</strong></label>
                <textarea id="adminReply" rows="2" class="form-control" placeholder="Nh·∫≠p ph·∫£n h·ªìi ho·∫∑c nh·∫•n Ghi nh·∫≠n..."></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary send-feedback-reply">G·ª≠i ph·∫£n h·ªìi</button>
              <button type="button" class="btn btn-outline-secondary acknowledge-feedback">Ghi nh·∫≠n</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Product Modal -->
  <div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content shadow-lg rounded-4">
        <div class="modal-header text-white rounded-top-4" style="background-color: #0D9BFF;">
          <h5 class="modal-title fw-bold" id="addProductModalLabel">
            <i class="bi bi-box-seam me-2"></i> Th√™m s·∫£n ph·∫©m m·ªõi
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
        </div>
        <div class="modal-body bg-light">
          <form id="productForm" class="p-2">
            
            <!-- H√¨nh ·∫£nh s·∫£n ph·∫©m -->
            <div class="mb-4">
              <label class="form-label fw-semibold">H√¨nh ·∫£nh s·∫£n ph·∫©m (t·ªëi ƒëa 4 h√¨nh)</label>
              <div class="row g-3" id="productImagesContainer">
                <!-- M·ªói ·∫£nh -->
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control product-image-input" accept="image/*" data-index="0">
                    <div class="image-preview mt-2" id="preview-0"></div>
                  </div>
                </div>
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control product-image-input" accept="image/*" data-index="1">
                    <div class="image-preview mt-2" id="preview-1"></div>
                  </div>
                </div>
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control product-image-input" accept="image/*" data-index="2">
                    <div class="image-preview mt-2" id="preview-2"></div>
                  </div>
                </div>
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control product-image-input" accept="image/*" data-index="3">
                    <div class="image-preview mt-2" id="preview-3"></div>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- Th√¥ng tin c∆° b·∫£n -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">T√™n s·∫£n ph·∫©m</label>
                <input type="text" class="form-control" id="productName" required>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Danh m·ª•c</label>
                <select class="form-select" id="productCategory" required>
                  <option value="">-- Ch·ªçn danh m·ª•c --</option>
                </select>
              </div>
            </div>
  
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">ƒê·ªô kh√≥</label>
                <select class="form-select" id="productAge">
                  <option value="">-- Ch·ªçn ƒë·ªô kh√≥ --</option>
                  <option value="Easy">D·ªÖ (Easy)</option>
                  <option value="Medium">Trung b√¨nh (Medium)</option>
                  <option value="Hard">Kh√≥ (Hard)</option>
                  <option value="Expert">Chuy√™n gia (Expert)</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">S·ªë m·∫£nh gh√©p</label>
                <input type="number" class="form-control" id="productPieces">
              </div>
            </div>
  
            <!-- Th√¥ng tin k·ªπ thu·∫≠t -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">T·ªìn kho</label>
                <input type="number" class="form-control" id="productStock" min="0" value="0">
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Tr·∫°ng th√°i</label>
                <select class="form-select" id="productStatus" required>
                  <option value="active">ƒêang b√°n</option>
                  <option value="inactive">Ng·ª´ng b√°n</option>
              
                </select>
              </div>
            </div>
  
            <!-- Gi√° -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">Gi√° g·ªëc (VND)</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-cash"></i></span>
                  <input type="number" class="form-control" id="productPrice" min="0" required>
                </div>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Gi√° khuy·∫øn m√£i (VND)</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-tag"></i></span>
                  <input type="number" class="form-control" id="productSalePrice" min="0" placeholder="ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng gi·∫£m gi√°">
                </div>
              </div>
            </div>

            <!-- K√≠ch th∆∞·ªõc & Tr·ªçng l∆∞·ª£ng -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">K√≠ch th∆∞·ªõc (cm)</label>
                <input type="text" class="form-control" id="productDimensions" placeholder="VD: 30x40x5">
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Tr·ªçng l∆∞·ª£ng (kg)</label>
                <input type="number" class="form-control" id="productWeight" min="0" step="0.01" placeholder="VD: 1.5">
              </div>
            </div>

            <!-- T·ªìn kho t·ªëi thi·ªÉu -->
            <div class="mb-3">
              <label class="form-label fw-semibold">M·ª©c t·ªìn kho t·ªëi thi·ªÉu</label>
              <input type="number" class="form-control" id="productMinStock" min="0" placeholder="C·∫£nh b√°o khi t·ªìn kho d∆∞·ªõi m·ª©c n√†y">
            </div>

            <!-- M√¥ t·∫£ -->
            <div class="mb-3">
              <label class="form-label fw-semibold">M√¥ t·∫£ ng·∫Øn</label>
              <textarea class="form-control" id="productShortDesc" rows="2" placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn (1-2 d√≤ng)"></textarea>
            </div>

            <div class="mb-3">
              <label class="form-label fw-semibold">M√¥ t·∫£ chi ti·∫øt</label>
              <textarea class="form-control" id="productDesc" rows="4" placeholder="Nh·∫≠p m√¥ t·∫£ chi ti·∫øt..."></textarea>
            </div>

            <!-- Thu·ªôc t√≠nh ƒë·∫∑c bi·ªát -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Thu·ªôc t√≠nh ƒë·∫∑c bi·ªát</label>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="productIsFeatured">
                <label class="form-check-label" for="productIsFeatured">
                  S·∫£n ph·∫©m n·ªïi b·∫≠t (Featured)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="productIsBestseller">
                <label class="form-check-label" for="productIsBestseller">
                  B√°n ch·∫°y nh·∫•t (Bestseller)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="productIsNew">
                <label class="form-check-label" for="productIsNew">
                  S·∫£n ph·∫©m m·ªõi (New)
                </label>
              </div>
            </div>
  
            <div class="modal-footer border-0">
              <button type="button" class="btn btn-danger rounded-pill px-4" data-bs-dismiss="modal">H·ªßy</button>
              <button type="submit" class="btn btn-primary rounded-pill px-4">
                <i class="bi bi-save me-1"></i> L∆∞u s·∫£n ph·∫©m
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  </div>
  

  <!-- Edit Product Modal -->
  <div class="modal fade" id="editProductModal" tabindex="-1" aria-labelledby="editProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content shadow-lg rounded-4">
        
        <!-- Header -->
        <div class="modal-header text-white rounded-top-4" style="background-color: #0D9BFF;">
          <h5 class="modal-title fw-bold" id="editProductModalLabel">
            <i class="bi bi-pencil-square me-2"></i> Ch·ªânh s·ª≠a s·∫£n ph·∫©m
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
        </div>
  
        <!-- Body -->
        <div class="modal-body bg-light">
          <form id="editProductForm" class="p-2">
            <input type="hidden" id="editProductId">
  
            <!-- ·∫¢nh s·∫£n ph·∫©m -->
            <div class="mb-4">
              <label class="form-label fw-semibold">H√¨nh ·∫£nh s·∫£n ph·∫©m (t·ªëi ƒëa 4 h√¨nh)</label>
              <div class="row g-3" id="editProductImagesContainer">
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control edit-product-image-input" accept="image/*" data-index="0">
                    <div class="image-preview mt-2" id="edit-preview-0"></div>
                  </div>
                </div>
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control edit-product-image-input" accept="image/*" data-index="1">
                    <div class="image-preview mt-2" id="edit-preview-1"></div>
                  </div>
                </div>
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control edit-product-image-input" accept="image/*" data-index="2">
                    <div class="image-preview mt-2" id="edit-preview-2"></div>
                  </div>
                </div>
                <div class="col-6 col-md-3 text-center">
                  <div class="border border-2 rounded-3 p-2 bg-white">
                    <input type="file" class="form-control edit-product-image-input" accept="image/*" data-index="3">
                    <div class="image-preview mt-2" id="edit-preview-3"></div>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- Th√¥ng tin c∆° b·∫£n -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">T√™n s·∫£n ph·∫©m</label>
                <input type="text" class="form-control" id="editProductName" required>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Danh m·ª•c</label>
                <select class="form-select" id="editProductCategory" required>
                  <option value="">-- Ch·ªçn danh m·ª•c --</option>
                </select>
              </div>
            </div>
  
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">ƒê·ªô kh√≥</label>
                <select class="form-select" id="editProductAge">
                  <option value="">-- Ch·ªçn ƒë·ªô kh√≥ --</option>
                  <option value="Easy">D·ªÖ (Easy)</option>
                  <option value="Medium">Trung b√¨nh (Medium)</option>
                  <option value="Hard">Kh√≥ (Hard)</option>
                  <option value="Expert">Chuy√™n gia (Expert)</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">S·ªë m·∫£nh gh√©p</label>
                <input type="number" class="form-control" id="editProductPieces">
              </div>
            </div>
  
            <!-- Th√¥ng tin k·ªπ thu·∫≠t -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">T·ªìn kho</label>
                <input type="number" class="form-control" id="editProductStock" min="0">
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Tr·∫°ng th√°i</label>
                <select class="form-select" id="editProductStatus" required>
                  <option value="active">ƒêang b√°n</option>
                  <option value="inactive">Ng·ª´ng b√°n</option>
                </select>
              </div>
            </div>
  
            <!-- Gi√° -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">Gi√° g·ªëc (VND)</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-cash"></i></span>
                  <input type="number" class="form-control" id="editProductPrice" min="0" required>
                </div>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Gi√° khuy·∫øn m√£i (VND)</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-tag"></i></span>
                  <input type="number" class="form-control" id="editProductSalePrice" min="0" placeholder="ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng gi·∫£m gi√°">
                </div>
              </div>
            </div>

            <!-- K√≠ch th∆∞·ªõc & Tr·ªçng l∆∞·ª£ng -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">K√≠ch th∆∞·ªõc (cm)</label>
                <input type="text" class="form-control" id="editProductDimensions" placeholder="VD: 30x40x5">
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Tr·ªçng l∆∞·ª£ng (kg)</label>
                <input type="number" class="form-control" id="editProductWeight" min="0" step="0.01" placeholder="VD: 1.5">
              </div>
            </div>

            <!-- T·ªìn kho t·ªëi thi·ªÉu -->
            <div class="mb-3">
              <label class="form-label fw-semibold">M·ª©c t·ªìn kho t·ªëi thi·ªÉu</label>
              <input type="number" class="form-control" id="editProductMinStock" min="0" placeholder="C·∫£nh b√°o khi t·ªìn kho d∆∞·ªõi m·ª©c n√†y">
            </div>

            <!-- M√¥ t·∫£ -->
            <div class="mb-3">
              <label class="form-label fw-semibold">M√¥ t·∫£ ng·∫Øn</label>
              <textarea class="form-control" id="editProductShortDesc" rows="2" placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn (1-2 d√≤ng)"></textarea>
            </div>

            <div class="mb-3">
              <label class="form-label fw-semibold">M√¥ t·∫£ chi ti·∫øt</label>
              <textarea class="form-control" id="editProductDesc" rows="4" placeholder="Nh·∫≠p m√¥ t·∫£ chi ti·∫øt..."></textarea>
            </div>

            <!-- Thu·ªôc t√≠nh ƒë·∫∑c bi·ªát -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Thu·ªôc t√≠nh ƒë·∫∑c bi·ªát</label>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="editProductIsFeatured">
                <label class="form-check-label" for="editProductIsFeatured">
                  S·∫£n ph·∫©m n·ªïi b·∫≠t (Featured)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="editProductIsBestseller">
                <label class="form-check-label" for="editProductIsBestseller">
                  B√°n ch·∫°y nh·∫•t (Bestseller)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="editProductIsNew">
                <label class="form-check-label" for="editProductIsNew">
                  S·∫£n ph·∫©m m·ªõi (New)
                </label>
              </div>
            </div>
  
            <!-- Footer -->
            <div class="modal-footer border-0">
              <button type="button" class="btn btn-danger rounded-pill px-4" data-bs-dismiss="modal">
                <i class="bi bi-x-circle me-1"></i> H·ªßy
              </button>
              <button type="submit" class="btn rounded-pill px-4 text-dark fw-semibold" style ="background-color: #0D9BFF; color: white;">
                <i class="bi bi-save2 me-1"></i> C·∫≠p nh·∫≠t s·∫£n ph·∫©m
              </button>
            </div>
  
          </form>
        </div>
      </div>
    </div>
  </div>
  

  <!-- Bulk Edit Advanced Modal -->
  <div class="modal fade" id="bulkEditAdvancedModal" tabindex="-1" aria-labelledby="bulkEditAdvancedModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header" style="background: #0D9BFF; color: white;">
          <h5 class="modal-title fw-bold" id="bulkEditAdvancedModalLabel">
            <i class="bi bi-pencil-square me-2"></i>Ch·ªânh s·ª≠a h√†ng lo·∫°t
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-4">
          <!-- Step 1: Select Field to Edit -->
          <div class="mb-4">
            <label class="form-label fw-bold text-primary">
              <i class="bi bi-sliders me-2"></i>Ch·ªçn ti√™u ch√≠ c·∫ßn s·ª≠a:
            </label>
            <select class="form-select form-select-lg" id="bulkEditField">
              <option value="">-- Ch·ªçn tr∆∞·ªùng mu·ªën ch·ªânh s·ª≠a --</option>
              <option value="status">Tr·∫°ng th√°i (active / inactive / draft)</option>
              <option value="category">Danh m·ª•c</option>
              <option value="price">Gi√° b√°n</option>
              <option value="sale_price">Gi√° khuy·∫øn m√£i</option>
              <option value="stock">S·ªë l∆∞·ª£ng t·ªìn kho</option>
              <option value="difficulty">ƒê·ªô kh√≥</option>
              <option value="piece_count">S·ªë m·∫£nh gh√©p</option>
              <option value="is_featured">S·∫£n ph·∫©m n·ªïi b·∫≠t</option>
              <option value="is_bestseller">B√°n ch·∫°y nh·∫•t</option>
              <option value="is_new">S·∫£n ph·∫©m m·ªõi</option>
            </select>
          </div>

          <!-- Step 2: Products Table -->
          <div class="card border-0 shadow-sm" id="bulkEditTableContainer" style="display: none;">
            <div class="card-header bg-light">
              <h6 class="mb-0 text-secondary">
                <i class="bi bi-list-check me-2"></i>S·∫£n ph·∫©m ƒë√£ ch·ªçn (<span id="bulkEditCount">0</span>)
              </h6>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
                <table class="table table-hover mb-0">
                  <thead class="sticky-top">
                    <tr>
                      <th style="width: 80px;">H√¨nh ·∫£nh</th>
                      <th style="width: 250px;">T√™n s·∫£n ph·∫©m</th>
                      <th style="width: 150px;">Danh m·ª•c</th>
                      <th style="width: 120px;">SKU</th>
                      <th>Gi√° tr·ªã hi·ªán t·∫°i</th>
                      <th>Gi√° tr·ªã m·ªõi</th>
                    </tr>
                  </thead>
                  <tbody id="bulkEditTableBody">
                    <!-- Dynamic rows will be inserted here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Helper Text -->
          <div class="alert alert-info mt-3" id="bulkEditHelper" style="display: none;">
            <i class="bi bi-info-circle me-2"></i>
            <span id="bulkEditHelperText">Ch·ªçn m·ªôt ti√™u ch√≠ ƒë·ªÉ b·∫Øt ƒë·∫ßu ch·ªânh s·ª≠a.</span>
          </div>
        </div>

        <div class="modal-footer border-0 bg-light">
          <button type="button" class="btn btn-danger rounded-1 px-4" data-bs-dismiss="modal">
            <i class="bi bi-x-circle me-1"></i> H·ªßy
          </button>
          <button type="button" class="btn btn-primary rounded-1 px-4" id="bulkEditSaveBtn" disabled>
            <i class="bi bi-save2 me-1"></i> L∆∞u thay ƒë·ªïi (<span id="bulkEditSaveCount">0</span>)
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Category Modal -->
  <div class="modal fade" id="addCategoryModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            <i class="bi bi-plus-circle me-2"></i>Th√™m Danh M·ª•c M·ªõi
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <form id="categoryForm">
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">T√™n Danh M·ª•c <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="category_name" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Slug <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="category_slug" required>
              <small class="text-muted">VD: lego-city, lego-technic (ch·ªØ th∆∞·ªùng, kh√¥ng d·∫•u, d√πng d·∫•u g·∫°ch ngang)</small>
            </div>
            <div class="mb-3">
              <label class="form-label">M√¥ T·∫£</label>
              <textarea class="form-control" name="description" rows="3"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-save me-1"></i>L∆∞u
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Edit Category Modal -->
  <div class="modal fade" id="editCategoryModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            <i class="bi bi-pencil me-2"></i>Ch·ªânh S·ª≠a Danh M·ª•c
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <form id="editCategoryForm">
          <input type="hidden" id="editCategoryId">
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">T√™n Danh M·ª•c <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="category_name" id="editCategoryName" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Slug <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="category_slug" id="editCategorySlug" required>
              <small class="text-muted">VD: lego-city, lego-technic (ch·ªØ th∆∞·ªùng, kh√¥ng d·∫•u, d√πng d·∫•u g·∫°ch ngang)</small>
            </div>
            <div class="mb-3">
              <label class="form-label">M√¥ T·∫£</label>
              <textarea class="form-control" name="description" id="editCategoryDescription" rows="3"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-save me-1"></i>C·∫≠p Nh·∫≠t
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Voucher Modal -->
  <div class="modal fade" id="addVoucherModal" tabindex="-1" aria-labelledby="addVoucherModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addVoucherModalLabel">Th√™m Voucher</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
        </div>
        <div class="modal-body">
          <form id="voucherForm">
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">T√™n phi·∫øu gi·∫£m gi√°</label>
                  <input type="text" class="form-control" id="voucherName" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Lo·∫°i gi·∫£m gi√°</label>
                  <select class="form-control" id="voucherType" required>
                    <option value="">Ch·ªçn lo·∫°i gi·∫£m gi√°</option>
                    <option value="percentage">Gi·∫£m theo ph·∫ßn trƒÉm (%)</option>
                    <option value="fixed">Gi·∫£m c·ªë ƒë·ªãnh (VND)</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Gi√° tr·ªã gi·∫£m</label>
                  <input type="number" class="form-control" id="voucherValue" min="0" required>
                  <small class="form-text text-muted" id="voucherValueHelp">Nh·∫≠p s·ªë ph·∫ßn trƒÉm ho·∫∑c s·ªë ti·ªÅn</small>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">M·ª©c gi·∫£m t·ªëi ƒëa (VND)</label>
                  <input type="number" class="form-control" id="voucherMaxDiscount" min="0">
                  <small class="form-text text-muted">Ch·ªâ √°p d·ª•ng cho gi·∫£m theo ph·∫ßn trƒÉm</small>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Ng√†y b·∫Øt ƒë·∫ßu √°p d·ª•ng</label>
                  <input type="datetime-local" class="form-control" id="voucherStartDate" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Ng√†y k·∫øt th√∫c √°p d·ª•ng</label>
                  <input type="datetime-local" class="form-control" id="voucherEndDate" required>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Gi√° tr·ªã ƒë∆°n h√†ng t·ªëi thi·ªÉu (VND)</label>
                  <input type="number" class="form-control" id="voucherMinOrder" min="0" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">S·ªë l·∫ßn ƒë∆∞·ª£c ph√©p s·ª≠ d·ª•ng</label>
                  <input type="number" class="form-control" id="voucherUsageLimit" min="1" required>
                </div>
              </div>
            </div>
            
            <div class="mb-3">
              <label class="form-label">M√¥ t·∫£ chi ti·∫øt</label>
              <textarea class="form-control" id="voucherDescription" rows="3" placeholder="M√¥ t·∫£ v·ªÅ voucher, ƒëi·ªÅu ki·ªán s·ª≠ d·ª•ng..."></textarea>
            </div>
            
            <div class="mb-3">
              <label class="form-label">Tr·∫°ng th√°i ho·∫°t ƒë·ªông</label>
              <select class="form-control" id="voucherStatus" required>
                <option value="active">ƒêang b·∫≠t</option>
                <option value="inactive">T·∫Øt</option>
              </select>
            </div>
            
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
              <button type="submit" class="btn btn-primary">L∆∞u Voucher</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Voucher Modal -->
  <div class="modal fade" id="editVoucherModal" tabindex="-1" aria-labelledby="editVoucherModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editVoucherModalLabel">Ch·ªânh s·ª≠a Voucher</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
        </div>
        <div class="modal-body">
          <form id="editVoucherForm">
            <input type="hidden" id="editVoucherId">
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">T√™n phi·∫øu gi·∫£m gi√°</label>
                  <input type="text" class="form-control" id="editVoucherName" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Lo·∫°i gi·∫£m gi√°</label>
                  <select class="form-control" id="editVoucherType" required>
                    <option value="">Ch·ªçn lo·∫°i gi·∫£m gi√°</option>
                    <option value="percentage">Gi·∫£m theo ph·∫ßn trƒÉm (%)</option>
                    <option value="fixed">Gi·∫£m c·ªë ƒë·ªãnh (VND)</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Gi√° tr·ªã gi·∫£m</label>
                  <input type="number" class="form-control" id="editVoucherValue" min="0" required>
                  <small class="form-text text-muted" id="editVoucherValueHelp">Nh·∫≠p s·ªë ph·∫ßn trƒÉm ho·∫∑c s·ªë ti·ªÅn</small>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">M·ª©c gi·∫£m t·ªëi ƒëa (VND)</label>
                  <input type="number" class="form-control" id="editVoucherMaxDiscount" min="0">
                  <small class="form-text text-muted">Ch·ªâ √°p d·ª•ng cho gi·∫£m theo ph·∫ßn trƒÉm</small>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Ng√†y b·∫Øt ƒë·∫ßu √°p d·ª•ng</label>
                  <input type="datetime-local" class="form-control" id="editVoucherStartDate" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Ng√†y k·∫øt th√∫c √°p d·ª•ng</label>
                  <input type="datetime-local" class="form-control" id="editVoucherEndDate" required>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Gi√° tr·ªã ƒë∆°n h√†ng t·ªëi thi·ªÉu (VND)</label>
                  <input type="number" class="form-control" id="editVoucherMinOrder" min="0" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">S·ªë l·∫ßn ƒë∆∞·ª£c ph√©p s·ª≠ d·ª•ng</label>
                  <input type="number" class="form-control" id="editVoucherUsageLimit" min="1" required>
                </div>
              </div>
            </div>
            
            <div class="mb-3">
              <label class="form-label">M√¥ t·∫£ chi ti·∫øt</label>
              <textarea class="form-control" id="editVoucherDescription" rows="3" placeholder="M√¥ t·∫£ v·ªÅ voucher, ƒëi·ªÅu ki·ªán s·ª≠ d·ª•ng..."></textarea>
            </div>
            
            <div class="mb-3">
              <label class="form-label">Tr·∫°ng th√°i ho·∫°t ƒë·ªông</label>
              <select class="form-control" id="editVoucherStatus" required>
                <option value="active">ƒêang b·∫≠t</option>
                <option value="inactive">T·∫Øt</option>
              </select>
            </div>
            
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
              <button type="submit" class="btn btn-primary">C·∫≠p nh·∫≠t Voucher</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Load Bootstrap JS first -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- T·∫£i c·∫•u h√¨nh m√¥i tr∆∞·ªùng tr∆∞·ªõc -->
  <script type="module" src="/dist/src/core/config/env.js"></script>
  <script type="module" src="/dist/src/assets/js/components/Admin.js"></script>
  
  <!-- Admin Product Management -->
  <script type="module">
    import { AdminProductController } from '/dist/src/modules/admin/AdminProductController.js';
    
    // Initialize Admin Product Controller
    const adminProductController = new AdminProductController();
    window.adminProductController = adminProductController;
  </script>

  <!-- Admin Category Management -->
  <script type="module">
    import { AdminCategoryController } from '/dist/src/modules/admin/AdminCategoryController.js';
    
    // Initialize Admin Category Controller
    const adminCategoryController = new AdminCategoryController();
    window.adminCategoryController = adminCategoryController;
  </script>

  <!-- Admin Order Management -->
  <script type="module">
    import { AdminOrderController } from '/dist/src/modules/admin/AdminOrderController.js';
    
    // Initialize Admin Order Controller
    const adminOrderController = new AdminOrderController();
    window.adminOrderController = adminOrderController;
  </script>
  
  <!-- ORDER MANAGEMENT INITIALIZATION -->
  <script>
     // Initialize Admin Order Controller when ready
     document.addEventListener('DOMContentLoaded', () => {
       // Wait for controller to be ready
       const waitForOrderController = setInterval(() => {
         if (window.adminOrderController) {
           clearInterval(waitForOrderController);
           initializeOrderSection();
         }
       }, 100);
     });
     
     function initializeOrderSection() {
       const orderSection = document.getElementById('order');
       
       // Setup order filters first
       setupOrderFilters();
       
       // LU√îN load orders khi page load (kh√¥ng ph·ª• thu·ªôc v√†o class active)
       // ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o data lu√¥n s·∫µn s√†ng, gi·ªëng nh∆∞ tr∆∞·ªõc khi th√™m Product Management
       window.adminOrderController.loadOrders();
       console.log('üì¶ Loading orders (always on page load)');
       
       // Load l·∫°i orders khi switching to order section (ƒë·ªÉ refresh data n·∫øu c·∫ßn)
       document.querySelectorAll('.menu li').forEach(item => {
         item.addEventListener('click', () => {
           const target = item.getAttribute('data-target');
           if (target === 'order') {
             window.adminOrderController.loadOrders();
             console.log('üì¶ Loading orders (clicked order tab - refreshing)');
           }
         });
       });
     }
     
     function setupOrderFilters() {
       const orderSection = document.getElementById('order');
       if (!orderSection) return;
       
       const toolbar = orderSection.querySelector('.toolbar');
       if (toolbar) {
         const searchInput = toolbar.querySelector('.search');
         
         // Add status filter
         const statusFilter = document.createElement('select');
         statusFilter.className = 'form-select d-inline-block w-auto ms-2';
         statusFilter.innerHTML = `
           <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
           <option value="ƒêang x·ª≠ l√Ω">ƒêang x·ª≠ l√Ω</option>
           <option value="ƒêang giao">ƒêang giao</option>
           <option value="ƒê√£ giao">ƒê√£ giao</option>
           <option value="ƒê√£ h·ªßy">ƒê√£ h·ªßy</option>
           <option value="ƒê√£ tr·∫£">ƒê√£ tr·∫£</option>
         `;
         
         // Add payment status filter
        const paymentFilter = document.createElement('select');
        paymentFilter.className = 'form-select d-inline-block w-auto ms-2';
         paymentFilter.innerHTML = `
           <option value="">T·∫•t c·∫£ thanh to√°n</option>
           <option value="pending">Ch∆∞a thanh to√°n</option>
           <option value="paid">ƒê√£ thanh to√°n</option>
           <option value="failed">Th·∫•t b·∫°i</option>
           <option value="refunded">ƒê√£ ho√†n ti·ªÅn</option>
         `;
         
         toolbar.appendChild(statusFilter);
         toolbar.appendChild(paymentFilter);
         
         // Helper function to load with all filters
         const loadWithFilters = () => {
           window.adminOrderController.loadOrders({
             status: statusFilter.value || undefined,
             paymentStatus: paymentFilter.value || undefined,
             search: searchInput?.value.trim() || undefined
           });
         };
         
         // Add event listeners
         statusFilter.addEventListener('change', loadWithFilters);
         paymentFilter.addEventListener('change', loadWithFilters);
         
         // Search input event listener
         if (searchInput) {
           let searchTimeout;
           searchInput.addEventListener('input', (e) => {
             clearTimeout(searchTimeout);
             searchTimeout = setTimeout(() => {
               loadWithFilters();
             }, 500);
           });
           
           searchInput.addEventListener('keypress', (e) => {
             if (e.key === 'Enter') {
               clearTimeout(searchTimeout);
               loadWithFilters();
             }
           });
         }
       }
     }
  </script>
  
  <!-- PRODUCT MANAGEMENT INITIALIZATION -->
  <script>
     // Initialize Admin Product Controller when ready
     document.addEventListener('DOMContentLoaded', () => {
       // Wait for controller to be ready
       const waitForProductController = setInterval(() => {
         if (window.adminProductController) {
           clearInterval(waitForProductController);
           initializeProductSection();
         }
       }, 100);
     });
     
     function initializeProductSection() {
       const productSection = document.getElementById('product');
       
       // Load categories first
       window.adminProductController.loadCategories();
       
       // Load products when product section is active
       if (productSection && productSection.classList.contains('active')) {
         window.adminProductController.loadProducts();
       }
       
       // Load products when switching to product section
       document.querySelectorAll('.menu li').forEach(item => {
         item.addEventListener('click', () => {
           const target = item.getAttribute('data-target');
           if (target === 'product') {
             window.adminProductController.loadProducts();
             window.adminProductController.loadCategories();
           }
         });
       });

       // Load categories when switching to categories tab
       const categoriesTab = document.getElementById('categories-tab');
       if (categoriesTab) {
         categoriesTab.addEventListener('shown.bs.tab', () => {
           console.log('üîÑ Switching to categories tab, loading categories...');
           if (window.adminCategoryController) {
             window.adminCategoryController.loadCategories();
           }
         });
       }
     }
        // DEMO DATA PH·∫¢N H·ªíI/ƒê√ÅNH GI√Å
        const feedbackListDemo = [
            {
                id: 'FB001',
                product: 'Xe c·∫£nh s√°t',
                productImg: 'img/Rectangle 108 (2).png',
                customer: 'Nguy·ªÖn VƒÉn A',
                customerEmail: 'vana@gmail.com',
                stars: 5,
                content: 'S·∫£n ph·∫©m r·∫•t t·ªët, giao h√†ng nhanh!',
                replied: false,
                adminReply: ''
            },
            {
                id: 'FB002',
                product: 'Xe x√¢y d·ª±ng v√†ng',
                productImg: 'img/Rectangle 108 (3).png',
                customer: 'Tr·∫ßn B·∫£o B',
                customerEmail: 'baobb@gmail.com',
                stars: 4,
                content: 'ƒê√∫ng m√¥ t·∫£, b√© nh√† m√¨nh th√≠ch l·∫Øm.',
                replied: false,
                adminReply: ''
            },
        ];
          // VOUCHER MANAGEMENT
          let vouchersData = [
            {
                id: 'VCH001',
                name: 'Gi·∫£m gi√° 20% cho ƒë∆°n h√†ng ƒë·∫ßu ti√™n',
                code: 'WELCOME20',
                type: 'percentage',
                value: 20,
                maxDiscount: 100000,
                startDate: '2024-01-01T00:00',
                endDate: '2024-12-31T23:59',
                minOrder: 200000,
                usageLimit: 1000,
                usedCount: 156,
                description: 'Voucher gi·∫£m gi√° 20% cho kh√°ch h√†ng m·ªõi, √°p d·ª•ng cho ƒë∆°n h√†ng ƒë·∫ßu ti√™n',
                status: 'active'
            },
            {
                id: 'VCH002',
                name: 'Gi·∫£m 50.000 VND cho ƒë∆°n h√†ng t·ª´ 500.000 VND',
                code: 'SAVE50K',
                type: 'fixed',
                value: 50000,
                maxDiscount: 0,
                startDate: '2024-01-15T00:00',
                endDate: '2024-06-30T23:59',
                minOrder: 500000,
                usageLimit: 500,
                usedCount: 89,
                description: 'Gi·∫£m gi√° c·ªë ƒë·ªãnh 50.000 VND cho ƒë∆°n h√†ng t·ª´ 500.000 VND tr·ªü l√™n',
                status: 'active'
            },
            {
                id: 'VCH003',
                name: 'Gi·∫£m gi√° 15% cho ng√†y l·ªÖ',
                code: 'HOLIDAY15',
                type: 'percentage',
                value: 15,
                maxDiscount: 200000,
                startDate: '2024-02-10T00:00',
                endDate: '2024-02-15T23:59',
                minOrder: 300000,
                usageLimit: 200,
                usedCount: 200,
                description: 'Voucher ƒë·∫∑c bi·ªát cho d·ªãp l·ªÖ T·∫øt, gi·∫£m 15% t·ªëi ƒëa 200.000 VND',
                status: 'expired'
            },
            {
                id: 'VCH004',
                name: 'Gi·∫£m 30.000 VND cho sinh nh·∫≠t',
                code: 'BIRTHDAY30',
                type: 'fixed',
                value: 30000,
                maxDiscount: 0,
                startDate: '2024-03-01T00:00',
                endDate: '2024-12-31T23:59',
                minOrder: 150000,
                usageLimit: 1,
                usedCount: 0,
                description: 'Voucher sinh nh·∫≠t ƒë·∫∑c bi·ªát, m·ªói kh√°ch h√†ng ch·ªâ ƒë∆∞·ª£c s·ª≠ d·ª•ng 1 l·∫ßn',
                status: 'inactive'
            }
        ];
        
        // Initialize voucher management
        initializeVoucherManagement();
        
        function initializeVoucherManagement() {
            renderVoucherList();
            setupVoucherFormHandlers();
            setupVoucherSearch();
        }
        
        function renderVoucherList() {
            const voucherList = document.getElementById('voucherList');
            if (!voucherList) return;
            
            voucherList.innerHTML = vouchersData.map(voucher => {
                const currentDate = new Date();
                const startDate = new Date(voucher.startDate);
                const endDate = new Date(voucher.endDate);
                const isExpired = currentDate > endDate;
                const isNotStarted = currentDate < startDate;
                
                let statusClass = voucher.status;
                if (isExpired) statusClass = 'expired';
                
                // Calculate usage percentage
                const usagePercentage = Math.round((voucher.usedCount / voucher.usageLimit) * 100);
                
                // Calculate time remaining
                const timeRemaining = calculateTimeRemaining(endDate);
                
                // Get voucher icon based on type
                const voucherIcon = voucher.type === 'percentage' ? '%' : '‚Ç´';
                
                return `
                    <div class="col-12 col-md-6">
                        <div class="voucher" onclick="editVoucher('${voucher.id}')">
                            <div class="voucher-left">
                                <span class="tag">S·ªë l∆∞·ª£ng c√≥ h·∫°n</span>
                                <div class="voucher-img">${voucherIcon}</div>
                            </div>
                            <div class="voucher-right">
                                <div class="voucher-title">
                                    <span class="badge">${voucher.type === 'percentage' ? 'Gi·∫£m %' : 'Gi·∫£m ti·ªÅn'}</span>
                                    ${voucher.name}
                                </div>
                                <div class="progress-bar">
                                    <div class="progress" style="width:${usagePercentage}%"></div>
                                </div>
                                <div class="voucher-info">
                                    <span>C√≤n ${100 - usagePercentage}%</span> - 
                                    <span class="expire">${timeRemaining}</span>
                                </div>
                                <div class="voucher-code-display">M√£: ${voucher.code}</div>
                                <div class="voucher-details-grid">
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">Gi√° tr·ªã:</span>
                                        <span class="voucher-detail-value">
                                            ${voucher.type === 'percentage' ? `${voucher.value}%` : `${voucher.value.toLocaleString()} VND`}
                                        </span>
                                    </div>
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">T·ªëi thi·ªÉu:</span>
                                        <span class="voucher-detail-value">${voucher.minOrder.toLocaleString()} VND</span>
                                    </div>
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">ƒê√£ d√πng:</span>
                                        <span class="voucher-detail-value">${voucher.usedCount}/${voucher.usageLimit}</span>
                                    </div>
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">Tr·∫°ng th√°i:</span>
                                        <span class="voucher-detail-value">
                                            ${statusClass === 'active' ? 'ƒêang b·∫≠t' : 
                                              statusClass === 'inactive' ? 'T·∫Øt' : 'H·∫øt h·∫°n'}
                                        </span>
                                    </div>
                                </div>
                                <div class="voucher-actions">
                                    <button class="view-btn" onclick="event.stopPropagation(); editVoucher('${voucher.id}')">
                                        Ch·ªânh s·ª≠a
                                    </button>
                                    <button class="delete-btn" onclick="event.stopPropagation(); deleteVoucher('${voucher.id}')">
                                        X√≥a
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            attachVoucherActionEvents();
        }
        
        function attachVoucherActionEvents() {
            // Edit voucher buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const voucherId = btn.getAttribute('onclick')?.match(/'([^']+)'/)?.[1];
                    if (voucherId) {
                        editVoucher(voucherId);
                    }
                });
            });
            
            // Delete voucher buttons
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const voucherId = btn.getAttribute('onclick')?.match(/'([^']+)'/)?.[1];
                    if (voucherId) {
                        deleteVoucher(voucherId);
                    }
                });
            });
        }
        
        function setupVoucherFormHandlers() {
            // Add voucher form
            const addVoucherForm = document.getElementById('voucherForm');
            if (addVoucherForm) {
                addVoucherForm.addEventListener('submit', handleAddVoucher);
            }
            
            // Edit voucher form
            const editVoucherForm = document.getElementById('editVoucherForm');
            if (editVoucherForm) {
                editVoucherForm.addEventListener('submit', handleEditVoucher);
            }
            
            // Voucher type change handlers
            setupVoucherTypeHandlers();
        }
        
        function setupVoucherTypeHandlers() {
            // Add voucher type handlers
            const addVoucherType = document.getElementById('voucherType');
            const addVoucherValueHelp = document.getElementById('voucherValueHelp');
            const addVoucherMaxDiscount = document.getElementById('voucherMaxDiscount');
            
            if (addVoucherType) {
                addVoucherType.addEventListener('change', function() {
                    const type = this.value;
                    if (type === 'percentage') {
                        addVoucherValueHelp.textContent = 'Nh·∫≠p s·ªë ph·∫ßn trƒÉm (v√≠ d·ª•: 20)';
                        addVoucherMaxDiscount.parentElement.style.display = 'block';
                    } else if (type === 'fixed') {
                        addVoucherValueHelp.textContent = 'Nh·∫≠p s·ªë ti·ªÅn gi·∫£m (v√≠ d·ª•: 50000)';
                        addVoucherMaxDiscount.parentElement.style.display = 'none';
                    } else {
                        addVoucherValueHelp.textContent = 'Nh·∫≠p s·ªë ph·∫ßn trƒÉm ho·∫∑c s·ªë ti·ªÅn';
                        addVoucherMaxDiscount.parentElement.style.display = 'block';
                    }
                });
            }
            
            // Edit voucher type handlers
            const editVoucherType = document.getElementById('editVoucherType');
            const editVoucherValueHelp = document.getElementById('editVoucherValueHelp');
            const editVoucherMaxDiscount = document.getElementById('editVoucherMaxDiscount');
            
            if (editVoucherType) {
                editVoucherType.addEventListener('change', function() {
                    const type = this.value;
                    if (type === 'percentage') {
                        editVoucherValueHelp.textContent = 'Nh·∫≠p s·ªë ph·∫ßn trƒÉm (v√≠ d·ª•: 20)';
                        editVoucherMaxDiscount.parentElement.style.display = 'block';
                    } else if (type === 'fixed') {
                        editVoucherValueHelp.textContent = 'Nh·∫≠p s·ªë ti·ªÅn gi·∫£m (v√≠ d·ª•: 50000)';
                        editVoucherMaxDiscount.parentElement.style.display = 'none';
                    } else {
                        editVoucherValueHelp.textContent = 'Nh·∫≠p s·ªë ph·∫ßn trƒÉm ho·∫∑c s·ªë ti·ªÅn';
                        editVoucherMaxDiscount.parentElement.style.display = 'block';
                    }
                });
            }
        }
        
        function handleAddVoucher(e) {
            e.preventDefault();
            
            const formData = {
                id: 'VCH' + String(vouchersData.length + 1).padStart(3, '0'),
                name: document.getElementById('voucherName').value,
                code: generateVoucherCode(),
                type: document.getElementById('voucherType').value,
                value: parseInt(document.getElementById('voucherValue').value),
                maxDiscount: parseInt(document.getElementById('voucherMaxDiscount').value) || 0,
                startDate: document.getElementById('voucherStartDate').value,
                endDate: document.getElementById('voucherEndDate').value,
                minOrder: parseInt(document.getElementById('voucherMinOrder').value),
                usageLimit: parseInt(document.getElementById('voucherUsageLimit').value),
                usedCount: 0,
                description: document.getElementById('voucherDescription').value,
                status: document.getElementById('voucherStatus').value
            };
            
            vouchersData.push(formData);
            renderVoucherList();
            
            // Reset form
            document.getElementById('voucherForm').reset();
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('addVoucherModal'))?.hide();
            
            alert('Th√™m voucher th√†nh c√¥ng!');
        }
        
        function editVoucher(voucherId) {
            const voucher = vouchersData.find(v => v.id === voucherId);
            if (!voucher) return;
            
            // Fill edit form
            document.getElementById('editVoucherId').value = voucher.id;
            document.getElementById('editVoucherName').value = voucher.name;
            document.getElementById('editVoucherType').value = voucher.type;
            document.getElementById('editVoucherValue').value = voucher.value;
            document.getElementById('editVoucherMaxDiscount').value = voucher.maxDiscount;
            document.getElementById('editVoucherStartDate').value = voucher.startDate;
            document.getElementById('editVoucherEndDate').value = voucher.endDate;
            document.getElementById('editVoucherMinOrder').value = voucher.minOrder;
            document.getElementById('editVoucherUsageLimit').value = voucher.usageLimit;
            document.getElementById('editVoucherDescription').value = voucher.description;
            document.getElementById('editVoucherStatus').value = voucher.status;
            
            // Trigger type change to update help text
            document.getElementById('editVoucherType').dispatchEvent(new Event('change'));
            
            // Show edit modal
            const editModal = new bootstrap.Modal(document.getElementById('editVoucherModal'));
            editModal.show();
        }
        
        function handleEditVoucher(e) {
            e.preventDefault();
            
            const voucherId = document.getElementById('editVoucherId').value;
            const voucherIndex = vouchersData.findIndex(v => v.id === voucherId);
            
            if (voucherIndex === -1) return;
            
            // Update voucher data
            vouchersData[voucherIndex] = {
                ...vouchersData[voucherIndex],
                name: document.getElementById('editVoucherName').value,
                type: document.getElementById('editVoucherType').value,
                value: parseInt(document.getElementById('editVoucherValue').value),
                maxDiscount: parseInt(document.getElementById('editVoucherMaxDiscount').value) || 0,
                startDate: document.getElementById('editVoucherStartDate').value,
                endDate: document.getElementById('editVoucherEndDate').value,
                minOrder: parseInt(document.getElementById('editVoucherMinOrder').value),
                usageLimit: parseInt(document.getElementById('editVoucherUsageLimit').value),
                description: document.getElementById('editVoucherDescription').value,
                status: document.getElementById('editVoucherStatus').value
            };
            
            renderVoucherList();
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('editVoucherModal'))?.hide();
            
            alert('C·∫≠p nh·∫≠t voucher th√†nh c√¥ng!');
        }
        
        function deleteVoucher(voucherId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a voucher n√†y?')) {
                const voucherIndex = vouchersData.findIndex(v => v.id === voucherId);
                if (voucherIndex !== -1) {
                    vouchersData.splice(voucherIndex, 1);
                    renderVoucherList();
                    alert('X√≥a voucher th√†nh c√¥ng!');
                }
            }
        }
        
        function setupVoucherSearch() {
            const searchInput = document.getElementById('voucherSearch');
            if (searchInput) {
                searchInput.addEventListener('input', function(e) {
                    const searchTerm = e.target.value.toLowerCase();
                    const filteredVouchers = vouchersData.filter(voucher => 
                        voucher.name.toLowerCase().includes(searchTerm) ||
                        voucher.code.toLowerCase().includes(searchTerm) ||
                        voucher.description.toLowerCase().includes(searchTerm)
                    );
                    
                    renderFilteredVoucherList(filteredVouchers);
                });
            }
        }
        
        function renderFilteredVoucherList(vouchers) {
            const voucherList = document.getElementById('voucherList');
            if (!voucherList) return;
            
            if (vouchers.length === 0) {
                voucherList.innerHTML = '<div class="col-12"><div class="text-center text-muted">Kh√¥ng t√¨m th·∫•y voucher n√†o</div></div>';
                return;
            }
            
            voucherList.innerHTML = vouchers.map(voucher => {
                const currentDate = new Date();
                const startDate = new Date(voucher.startDate);
                const endDate = new Date(voucher.endDate);
                const isExpired = currentDate > endDate;
                
                let statusClass = voucher.status;
                if (isExpired) statusClass = 'expired';
                
                // Calculate usage percentage
                const usagePercentage = Math.round((voucher.usedCount / voucher.usageLimit) * 100);
                
                // Calculate time remaining
                const timeRemaining = calculateTimeRemaining(endDate);
                
                // Get voucher icon based on type
                const voucherIcon = voucher.type === 'percentage' ? '%' : '‚Ç´';
                
                return `
                    <div class="col-12 col-md-6">
                        <div class="voucher" onclick="editVoucher('${voucher.id}')">
                            <div class="voucher-left">
                                <span class="tag">S·ªë l∆∞·ª£ng c√≥ h·∫°n</span>
                                <div class="voucher-img">${voucherIcon}</div>
                            </div>
                            <div class="voucher-right">
                                <div class="voucher-title">
                                    <span class="badge">${voucher.type === 'percentage' ? 'Gi·∫£m %' : 'Gi·∫£m ti·ªÅn'}</span>
                                    ${voucher.name}
                                </div>
                                <div class="progress-bar">
                                    <div class="progress" style="width:${usagePercentage}%"></div>
                                </div>
                                <div class="voucher-info">
                                    <span>C√≤n ${100 - usagePercentage}%</span> - 
                                    <span class="expire">${timeRemaining}</span>
                                </div>
                                <div class="voucher-code-display">M√£: ${voucher.code}</div>
                                <div class="voucher-details-grid">
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">Gi√° tr·ªã:</span>
                                        <span class="voucher-detail-value">
                                            ${voucher.type === 'percentage' ? `${voucher.value}%` : `${voucher.value.toLocaleString()} VND`}
                                        </span>
                                    </div>
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">T·ªëi thi·ªÉu:</span>
                                        <span class="voucher-detail-value">${voucher.minOrder.toLocaleString()} VND</span>
                                    </div>
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">ƒê√£ d√πng:</span>
                                        <span class="voucher-detail-value">${voucher.usedCount}/${voucher.usageLimit}</span>
                                    </div>
                                    <div class="voucher-detail-item">
                                        <span class="voucher-detail-label">Tr·∫°ng th√°i:</span>
                                        <span class="voucher-detail-value">
                                            ${statusClass === 'active' ? 'ƒêang b·∫≠t' : 
                                              statusClass === 'inactive' ? 'T·∫Øt' : 'H·∫øt h·∫°n'}
                                        </span>
                                    </div>
                                </div>
                                <div class="voucher-actions">
                                    <button class="view-btn" onclick="event.stopPropagation(); editVoucher('${voucher.id}')">
                                        Ch·ªânh s·ª≠a
                                    </button>
                                    <button class="delete-btn" onclick="event.stopPropagation(); deleteVoucher('${voucher.id}')">
                                        X√≥a
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            attachVoucherActionEvents();
        }
        
        function generateVoucherCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        function formatDateRange(startDate, endDate) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            const startStr = start.toLocaleDateString('vi-VN');
            const endStr = end.toLocaleDateString('vi-VN');
            return `${startStr} - ${endStr}`;
        }
        
        function calculateTimeRemaining(endDate) {
            const now = new Date();
            const end = new Date(endDate);
            const diff = end - now;
            
            if (diff <= 0) {
                return 'ƒê√£ h·∫øt h·∫°n';
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            if (days > 0) {
                return `H·∫øt h·∫°n sau ${days} ng√†y`;
            } else if (hours > 0) {
                return `H·∫øt h·∫°n sau ${hours} gi·ªù`;
            } else {
                return `H·∫øt h·∫°n sau ${minutes} ph√∫t`;
            }
        }
        
  </script>
  <script>
    document.querySelectorAll('.menu li').forEach(item => {
      item.addEventListener('click', () => {
        document.querySelectorAll('.menu li').forEach(li => li.classList.remove('active'));
        document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
        item.classList.add('active');
        const target = item.getAttribute('data-target');
        document.getElementById(target).classList.add('active');
      });
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const toggleBtn = document.getElementById('toggleSidebarBtn');
      const sidebar = document.querySelector('.sidebar');
      if (toggleBtn && sidebar) {
        toggleBtn.addEventListener('click', function() {
          sidebar.classList.toggle('active');
        });
      }
      // Auto-close sidebar on menu click in mobile view
      document.querySelectorAll('.menu li').forEach(item => {
        item.addEventListener('click', () => {
          if (window.innerWidth <= 991 && sidebar && sidebar.classList.contains('active')) {
            sidebar.classList.remove('active');
          }
        });
      });
    });
  </script>
</body>

</html>
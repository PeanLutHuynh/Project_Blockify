<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n l√Ω x·ª≠ l√Ω ƒë∆°n h√†ng</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .table-container {
      background: white; border-radius: 10px; padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .customer-info { display: flex; align-items: center; gap: 10px; }
    .customer-info img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
    .status { border-radius: 8px; padding: 4px 10px; font-size: 0.85rem; color: white; font-weight: 500; }
    .status-confirm { background: #6c757d; }
    .status-shipping { background: #0d6efd; }
    .status-done { background: #28a745; }
    .status-cancel { background: #dc3545; }
    .status-return { background: #ffc107; color: #212529; }
  </style>
</head>
<body>

<div class="container my-4">
  <div class="table-container">
    <h4 class="mb-3">üì¶ Qu·∫£n l√Ω ƒë∆°n h√†ng</h4>
    <table class="table align-middle text-center" id="orderTable">
      <thead>
        <tr>
          <th>#</th>
          <th>M√£ ƒë∆°n</th>
          <th>Kh√°ch h√†ng</th>
          <th>S·∫£n ph·∫©m</th>
          <th>Tr·∫°ng th√°i</th>
          <th>Ng√†y t·∫°o</th>
          <th>T·ªïng ti·ªÅn</th>
          <th>H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody id="orderBody"></tbody>
    </table>
  </div>
</div>

<!-- Modal Chi ti·∫øt ƒê∆°n h√†ng -->
<div class="modal fade" id="orderDetailModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg"><div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Chi ti·∫øt ƒë∆°n h√†ng</h5>
      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
    </div>
    <div class="modal-body">
      <div class="container">
        <div class="row mb-2"><div class="col-5 fw-semibold">Kh√°ch h√†ng:</div><div class="col" id="detailCustomerName"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">Email:</div><div class="col" id="detailCustomerEmail"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">SƒêT:</div><div class="col" id="detailCustomerPhone"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">ƒê·ªãa ch·ªâ:</div><div class="col" id="detailCustomerAddress"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">Ph∆∞∆°ng th·ª©c:</div><div class="col" id="detailPaymentMethod"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">M√£ h√≥a ƒë∆°n:</div><div class="col" id="detailOrderId"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">T√™n ƒë∆°n:</div><div class="col" id="detailOrderName"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">S·ªë l∆∞·ª£ng:</div><div class="col" id="detailOrderQuantity"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">M·∫´u h√†ng:</div><div class="col" id="detailOrderVariant"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">T·ªïng ti·ªÅn:</div><div class="col" id="detailOrderTotal"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">Tr·∫°ng th√°i:</div><div class="col" id="detailOrderStatus"></div></div>
        <div class="row mb-2"><div class="col-5 fw-semibold">H√¨nh s·∫£n ph·∫©m:</div><div class="col"><img id="detailProductImg" src="" class="img-fluid mb-2" style="max-width: 100px;"></div></div>
        <div class="row mb-2">
          <div class="col-5 fw-semibold">Minh ch·ª©ng thanh to√°n:</div>
          <div class="col">
            <img id="detailPayProof" src="" class="img-fluid" style="max-width: 120px;">
            <div class="mt-2">
              <span class="badge bg-secondary" id="paymentStatusBadge">Ch∆∞a ki·ªÉm tra</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer order-action-footer">
      <button type="button" class="btn btn-success next-status-btn">C·∫≠p nh·∫≠t tr·∫°ng th√°i</button>
      <button type="button" class="btn btn-warning refund-btn">X·ª≠ l√Ω ho√†n tr·∫£</button>
      <button type="button" class="btn btn-danger cancel-btn">H·ªßy ƒë∆°n</button>
      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
    </div>
  </div></div>
</div>

<!-- Modal X·ª≠ l√Ω ho√†n tr·∫£ -->
<div class="modal fade" id="refundModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog"><div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">X·ª≠ l√Ω ho√†n/tr·∫£ h√†ng</h5>
      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
    </div>
    <div class="modal-body">
      <form id="refundForm">
        <div class="mb-3">
          <label class="form-label">S·∫£n ph·∫©m ho√†n tr·∫£</label>
          <input type="text" id="refundProduct" class="form-control" readonly>
        </div>
        <div class="mb-3">
          <label class="form-label">L√Ω do ho√†n tr·∫£</label>
          <textarea id="refundReason" class="form-control" rows="3" placeholder="Nh·∫≠p l√Ω do ho√†n/tr·∫£ h√†ng..."></textarea>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-success" id="confirmRefund">X√°c nh·∫≠n ho√†n tr·∫£</button>
      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
    </div>
  </div></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
const orders = [
  { 
    id: 301, customer: "H√† My", product: "V√°y tr·∫Øng cao c·∫•p", status: "Ch·ªù x√°c nh·∫≠n", 
    total: "1.200.000", date: "22/10/2025", returnReason: "",
    email: "hamy@email.com", phone: "0912345678", address: "123 Nguy·ªÖn Hu·ªá, Q1, TP.HCM",
    payment: "Chuy·ªÉn kho·∫£n", quantity: 1, variant: "Size M - Tr·∫Øng",
    productImg: "https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=300",
    payProof: "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=300"
  },
  { 
    id: 302, customer: "Ph√∫c L√™", product: "√Åo s∆° mi nam c√¥ng s·ªü", status: "ƒêang giao", 
    total: "450.000", date: "21/10/2025", returnReason: "",
    email: "phucle@email.com", phone: "0987654321", address: "456 L√™ L·ª£i, Q3, TP.HCM",
    payment: "COD", quantity: 2, variant: "Size L - Xanh Navy",
    productImg: "https://images.unsplash.com/photo-1602810318383-e386cc2a3ccf?w=300",
    payProof: "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=300"
  },
  { 
    id: 303, customer: "Tr√¢m Anh", product: "B·ªô th·ªÉ thao n·ªØ", status: "ƒê√£ giao", 
    total: "780.000", date: "20/10/2025", returnReason: "",
    email: "tramanh@email.com", phone: "0901234567", address: "789 V√µ VƒÉn T·∫ßn, Q3, TP.HCM",
    payment: "Chuy·ªÉn kho·∫£n", quantity: 1, variant: "Size S - ƒêen",
    productImg: "https://images.unsplash.com/photo-1518002171953-a080ee817e1f?w=300",
    payProof: "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=300"
  },
  { 
    id: 304, customer: "Tu·∫•n Ki·ªát", product: "Gi√†y th·ªÉ thao Nike", status: "ƒê√£ hu·ª∑", 
    total: "1.500.000", date: "18/10/2025", returnReason: "",
    email: "tuankiet@email.com", phone: "0923456789", address: "321 Hai B√† Tr∆∞ng, Q1, TP.HCM",
    payment: "Chuy·ªÉn kho·∫£n", quantity: 1, variant: "Size 42 - ƒêen Tr·∫Øng",
    productImg: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=300",
    payProof: "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=300"
  },
  { 
    id: 305, customer: "Lan H∆∞∆°ng", product: "T√∫i x√°ch da b√≤", status: "Ho√†n tr·∫£", 
    total: "2.100.000", date: "15/10/2025", returnReason: "S·∫£n ph·∫©m l·ªói ƒë∆∞·ªùng may",
    email: "lanhuong@email.com", phone: "0934567890", address: "654 Tr·∫ßn H∆∞ng ƒê·∫°o, Q5, TP.HCM",
    payment: "Chuy·ªÉn kho·∫£n", quantity: 1, variant: "M√†u N√¢u - Da th·∫≠t",
    productImg: "https://images.unsplash.com/photo-1548036328-c9fa89d128fa?w=300",
    payProof: "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=300"
  }
];

const statusClass = {
  "Ch·ªù x√°c nh·∫≠n": "status-confirm",
  "ƒêang giao": "status-shipping",
  "ƒê√£ giao": "status-done",
  "ƒê√£ hu·ª∑": "status-cancel",
  "Ho√†n tr·∫£": "status-return"
};

const orderBody = document.getElementById("orderBody");
const detailModal = new bootstrap.Modal(document.getElementById("orderDetailModal"));
const refundModal = new bootstrap.Modal(document.getElementById("refundModal"));

function renderTable() {
  orderBody.innerHTML = "";
  orders.forEach((order, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${i + 1}</td>
      <td>${order.id}</td>
      <td>${order.customer}</td>
      <td>${order.product}</td>
      <td><span class="status ${statusClass[order.status]}">${order.status}</span></td>
      <td>${order.date}</td>
      <td>${order.total}</td>
      <td><button class="btn btn-primary btn-sm view-btn">Xem</button></td>
    `;

    tr.querySelector(".view-btn").addEventListener("click", () => openDetail(order));
    orderBody.appendChild(tr);
  });
}

function openDetail(order) {
  document.getElementById("detailCustomerName").textContent = order.customer;
  document.getElementById("detailCustomerEmail").textContent = order.email;
  document.getElementById("detailCustomerPhone").textContent = order.phone;
  document.getElementById("detailCustomerAddress").textContent = order.address;
  document.getElementById("detailPaymentMethod").textContent = order.payment;
  document.getElementById("detailOrderId").textContent = order.id;
  document.getElementById("detailOrderName").textContent = order.product;
  document.getElementById("detailOrderQuantity").textContent = order.quantity;
  document.getElementById("detailOrderVariant").textContent = order.variant;
  document.getElementById("detailOrderTotal").textContent = order.total;
  document.getElementById("detailOrderStatus").innerHTML = `<span class="status ${statusClass[order.status]}">${order.status}</span>`;
  document.getElementById("detailProductImg").src = order.productImg;
  document.getElementById("detailPayProof").src = order.payProof;

  const footer = document.querySelector(".order-action-footer");
  footer.querySelector(".next-status-btn").onclick = () => updateStatus(order);
  footer.querySelector(".refund-btn").onclick = () => handleRefund(order);
  footer.querySelector(".cancel-btn").onclick = () => cancelOrder(order);

  detailModal.show();
}

function updateStatus(order) {
  if (order.status === "Ch·ªù x√°c nh·∫≠n") order.status = "ƒêang giao";
  else if (order.status === "ƒêang giao") order.status = "ƒê√£ giao";
  else alert("ƒê∆°n h√†ng ƒë√£ ho√†n t·∫•t ho·∫∑c kh√¥ng th·ªÉ c·∫≠p nh·∫≠t!");
  renderTable();
  openDetail(order);
}

function cancelOrder(order) {
  if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën h·ªßy ƒë∆°n n√†y kh√¥ng?")) {
    order.status = "ƒê√£ hu·ª∑";
    renderTable();
    openDetail(order);
  }
}

function handleRefund(order) {
  document.getElementById("refundProduct").value = order.product;
  document.getElementById("refundReason").value = order.returnReason;
  refundModal.show();

  document.getElementById("confirmRefund").onclick = () => {
    const reason = document.getElementById("refundReason").value.trim();
    if (!reason) return alert("Vui l√≤ng nh·∫≠p l√Ω do ho√†n tr·∫£!");
    order.status = "Ho√†n tr·∫£";
    order.returnReason = reason;
    refundModal.hide();
    renderTable();
    openDetail(order);
  };
}

renderTable();
</script>
</body>
</html>